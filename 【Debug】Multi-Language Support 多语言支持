---
title: ""
datePublished: Sat Jan 10 2026 07:49:22 GMT+0000 (Coordinated Universal Time)
cuid: cmk8082na000802lahtv90c8f
slug: debug-implementing-multi-language-support
ogImage: https://cdn.hashnode.com/res/hashnode/image/upload/v1768031237625/972674cd-96eb-4a53-a52e-b39c486db550.png
tags: debugging, reactjs, frontend-development, english, chinese

---

## Thumbnail ç¼©ç•¥å›¾

![](https://cdn.hashnode.com/res/hashnode/image/upload/v1768031053346/64fdc83c-0be7-404c-91d0-41c0c00e4c1d.png align="center")

## The Challenge æŒ‘æˆ˜

One of the features I wanted to add to my admin system was multi-language support for Chinese, Japanese, and English. As someone studying in Tokyo and preparing for the Japanese IT job market, I knew internationalization was an important skill to master.  
æˆ‘æƒ³ä¸ºæˆ‘çš„ç®¡ç†ç³»ç»Ÿæ·»åŠ çš„åŠŸèƒ½ä¹‹ä¸€æ˜¯æ”¯æŒä¸­æ–‡ã€æ—¥æ–‡å’Œè‹±æ–‡çš„å¤šè¯­è¨€ã€‚ä½œä¸ºä¸€ä¸ªåœ¨ä¸œäº¬å­¦ä¹ å¹¶ä¸ºåœ¨æ—¥æœ¬å°±ä¸šåšå‡†å¤‡çš„äººï¼Œæˆ‘çŸ¥é“å›½é™…åŒ–æ˜¯ä¸€é¡¹é‡è¦çš„æŠ€èƒ½ã€‚

## Initial Setup åˆå§‹è®¾ç½®

I chose **react-i18next** as my internationalization library. The setup process seemed straightforward based on the documentation:  
æˆ‘é€‰æ‹©äº†react-i18nextä½œä¸ºæˆ‘çš„å›½é™…åŒ–åº“ã€‚æ ¹æ®æ–‡æ¡£ï¼Œè®¾ç½®è¿‡ç¨‹çœ‹èµ·æ¥å¾ˆç®€å•ï¼š

**Step 1: Install dependencies  
æ­¥éª¤1ï¼šå®‰è£…ä¾èµ–**

**Step 2: Create translation files  
æ­¥éª¤2ï¼šåˆ›å»ºç¿»è¯‘æ–‡ä»¶**

I organized my translations in a structured folder:  
æˆ‘æŠŠç¿»è¯‘æ•´ç†åœ¨ä¸€ä¸ªç»“æ„åŒ–æ–‡ä»¶å¤¹é‡Œï¼š

```plaintext
textsrc/locales/
  â”œâ”€â”€ zh/translation.json  # Chinese
  â”œâ”€â”€ ja/translation.json  # Japanese
  â””â”€â”€ en/translation.json  # English
```

Each translation file contained the same keys with different values:  
æ¯ä¸ªç¿»è¯‘æ–‡ä»¶åŒ…å«ç›¸åŒçš„é”®ï¼Œä½†å–å€¼ä¸åŒï¼š

```plaintext
json// zh/translation.json
{
  "header": {
    "title": "ç³»ç»Ÿç®¡ç†é¢æ¿"
  },
  "menu": {
    "dashboard": "ä»ªè¡¨ç›˜",
    "users": "ç”¨æˆ·ç®¡ç†",
    "settings": "è®¾ç½®"
  }
}
```

**Step 3: Configure i18nÂ Â æ­¥éª¤ 3ï¼šé…ç½® i18n**

I created `src/i18n.ts`:  
æˆ‘åˆ›å»ºäº†src/i18n.tsï¼š

```plaintext
typescriptimport i18n from 'i18next';
import { initReactI18next } from 'react-i18next';
import zh from './locales/zh/translation.json';
import ja from './locales/ja/translation.json';
import en from './locales/en/translation.json';

i18n
  .use(initReactI18next)
  .init({
    resources: {
      zh: { translation: zh },
      ja: { translation: ja },
      en: { translation: en },
    },
    lng: localStorage.getItem('language') || 'zh',
    fallbackLng: 'zh',
    interpolation: {
      escapeValue: false,
    },
  });

export default i18n;
```

## The First Bug: Translation Keys Showing as Raw Text

## ç¬¬ä¸€ä¸ª bugï¼šç¿»è¯‘é”®æ˜¾ç¤ºä¸ºåŸå§‹æ–‡æœ¬

After implementing the language switcher button, I excitedly clicked it to testâ€¦â€¦then saw this:  
å®ç°è¯­è¨€åˆ‡æ¢æŒ‰é’®åï¼Œæˆ‘å…´å¥‹åœ°ç‚¹å‡»å®ƒæµ‹è¯•â€¦â€¦ç„¶åçœ‹åˆ°äº†è¿™ä¸ªï¼š

```plaintext
textt('menu.dashboard')
```

The actual translation key was displaying instead of the translated text! My first thought was: "Did I configure something wrong?"  
å®é™…æ˜¾ç¤ºçš„ç¿»è¯‘é”®è€Œä¸æ˜¯ç¿»è¯‘åçš„æ–‡æœ¬ï¼æˆ‘ç¬¬ä¸€ååº”æ˜¯ï¼šâ€œæˆ‘æ˜¯ä¸æ˜¯é…ç½®é”™äº†ä»€ä¹ˆï¼Ÿâ€

**The Problem é—®é¢˜ï¼š**

I had written the JSX like this:  
æˆ‘å†™ JSX æ˜¯è¿™æ ·å†™çš„ï¼š

```plaintext
tsx<Typography variant="h6">
  t{'menu.dashboard'}  //Wrong syntax!
</Typography>
```

**The Solution è§£å†³æ–¹æ¡ˆï¼š**

The correct syntax for using translation functions in JSX requires proper brackets:  
åœ¨ JSX ä¸­ä½¿ç”¨ç¿»è¯‘å‡½æ•°çš„æ­£ç¡®è¯­æ³•éœ€è¦é€‚å½“çš„æ‹¬å·ï¼š

```plaintext
tsx<Typography variant="h6">
  {t('menu.dashboard')}  //Correct!
</Typography>
```

**Key Learning å…³é”®å­¦ä¹ :**

In JSX, you need `{}` for JavaScript expressions and `()` for function calls. The pattern is always `{functionName('parameter')}`.  
**ï¼š** åœ¨ JSX ä¸­ï¼ŒJavaScript è¡¨è¾¾å¼éœ€è¦ {}ï¼Œå‡½æ•°è°ƒç”¨éœ€è¦ï¼ˆï¼‰è¡¨ç¤ºã€‚è¯¥æ¨¡å¼å§‹ç»ˆä¸º {functionNameï¼ˆ'parameter'ï¼‰}ã€‚

## The Second Bug: Translations Not Loading

## ç¬¬äºŒä¸ª bugï¼šç¿»è¯‘æ— æ³•åŠ è½½

Even after fixing the syntax, I still saw the translation keys instead of actual text. The browser console showed no errors, which made debugging more challenging.  
å³ä½¿ä¿®æ­£äº†è¯­æ³•ï¼Œæˆ‘ä»ç„¶çœ‹åˆ°ç¿»è¯‘é”®è€Œä¸æ˜¯æ­£æ–‡ã€‚æµè§ˆå™¨æ§åˆ¶å°æ²¡æœ‰æ˜¾ç¤ºé”™è¯¯ï¼Œè¿™è®©è°ƒè¯•å˜å¾—æ›´åŠ å›°éš¾ã€‚

**The Investigation è°ƒæŸ¥å†…å®¹ï¼š**

I added debug logging to my i18n configuration:  
æˆ‘åœ¨æˆ‘çš„ i18n é…ç½®ä¸­æ·»åŠ äº†è°ƒè¯•æ—¥å¿—åŠŸèƒ½ï¼š

```plaintext
typescripti18n.init({
  // ... other config
  debug: true,  // Added this line
});

console.log('i18n initialized:', i18n.isInitialized);
console.log('Current language:', i18n.language);
```

The console revealed that i18n was loading after my components had already rendered!  
æ§åˆ¶å°æ˜¾ç¤º i18n åŠ è½½æ—¶ï¼Œæˆ‘çš„ç»„ä»¶å·²ç»æ¸²æŸ“å®Œæ¯•ï¼

**The Root Cause æ ¹æœ¬åŸå› ï¼š**

My `main.tsx` import order was wrong:  
æˆ‘çš„ main.tsx å¯¼å…¥é¡ºåºæœ‰è¯¯ï¼š

```plaintext
tsximport App from './App.tsx'
import './i18n'  //Wrong
```

**The Fix è§£å†³åŠæ³•ï¼š**

I reordered the imports:  
æˆ‘é‡æ–°æ’åºäº†å¯¼å…¥å†…å®¹ï¼š

```plaintext
tsximport './i18n'  //Must come before App
import App from './App.tsx'
```

And wrapped the app with React Suspense:  
å¹¶ç”¨ React Suspense æ¥åŒ…è£…åº”ç”¨ï¼š

```plaintext
tsximport { Suspense } from 'react';

<Suspense fallback={<div>Loading...</div>}>
  <App />
</Suspense>
```

## Building the Language Switcher

## æ„å»ºè¯­è¨€åˆ‡æ¢æŒ‰é’®

With translations working, I created the language switcher button in my dashboard layout:  
ç¿»è¯‘åŠŸèƒ½æ­£å¸¸åï¼Œæˆ‘åœ¨ä»ªè¡¨ç›˜å¸ƒå±€ä¸­åˆ›å»ºäº†è¯­è¨€åˆ‡æ¢æŒ‰é’®ï¼š

```plaintext
tsxconst { t, i18n } = useTranslation();
const [languageAnchorEl, setLanguageAnchorEl] = useState<null | HTMLElement>(null);

const handleLanguageChange = (lang: string) => {
  i18n.changeLanguage(lang);
  localStorage.setItem('language', lang);
  setLanguageAnchorEl(null);
};

// In the JSX:
<IconButton color="inherit" onClick={handleLanguageMenuOpen}>
  <Translate />
</IconButton>

<Menu
  anchorEl={languageAnchorEl}
  open={Boolean(languageAnchorEl)}
  onClose={handleLanguageMenuClose}
>
  <MenuItem onClick={() => handleLanguageChange('zh')}>
    ğŸ‡¨ğŸ‡³ ä¸­æ–‡
  </MenuItem>
  <MenuItem onClick={() => handleLanguageChange('ja')}>
    ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª
  </MenuItem>
  <MenuItem onClick={() => handleLanguageChange('en')}>
    ğŸ‡¬ğŸ‡§ English
  </MenuItem>
</Menu>
```

## The Forgotten Components

## è¢«é—å¿˜çš„ç»„æˆéƒ¨åˆ†

After implementing the language switcher in my main layout, I tested it and everything looked perfectâ€¦â€¦until I navigated to the Dashboard page and saw this error:  
åœ¨ä¸»å¸ƒå±€ä¸­å®ç°è¯­è¨€åˆ‡æ¢å™¨åï¼Œæˆ‘æµ‹è¯•äº†ä¸€ä¸‹ï¼Œä¸€åˆ‡çœ‹èµ·æ¥éƒ½å¾ˆå®Œç¾......ç›´åˆ°æˆ‘è¿›å…¥ä»ªè¡¨ç›˜é¡µé¢ï¼Œçœ‹åˆ°è¿™ä¸ªé”™è¯¯ï¼š

```plaintext
textUncaught ReferenceError: t is not defined
```

**The Mistake é”™è¯¯ï¼š**

I had added multi-language support to my layout component but forgot to update the individual page components! Each component that uses translations needs its own useTranslation hook.  
æˆ‘ä¹‹å‰ç»™å¸ƒå±€ç»„ä»¶æ·»åŠ äº†å¤šè¯­è¨€æ”¯æŒï¼Œä½†å¿˜äº†æ›´æ–°å„ä¸ªé¡µé¢ç»„ä»¶ï¼æ¯ä¸ªä½¿ç”¨ç¿»è¯‘çš„ç»„ä»¶éƒ½éœ€è¦è‡ªå·±çš„ useTranslation é’©å­ã€‚

**The Fix è§£å†³åŠæ³•ï¼š**

I updated every page component:  
æˆ‘æ›´æ–°äº†æ‰€æœ‰é¡µé¢ç»„ä»¶ï¼š

```plaintext
tsximport { useTranslation } from 'react-i18next';

export default function Dashboard() {
  const { t } = useTranslation();  // Added this line
  
  return (
    <Typography variant="h4">
      {t('menu.dashboard')}
    </Typography>
  );
}
```

## What I Learned æˆ‘å­¦åˆ°äº†ä»€ä¹ˆ

1. Dependencies like i18n must be initialized before components mount. Import order matters in React applications!  
    åƒ i18n è¿™æ ·çš„ä¾èµ–å¿…é¡»åœ¨ç»„ä»¶æŒ‚è½½å‰åˆå§‹åŒ–ã€‚å¯¼å…¥é¡ºåºåœ¨ React åº”ç”¨ä¸­å¾ˆé‡è¦ï¼
    
2. React hooks can't be shared across components. Each component using translations needs `useTranslation()`.  
    React é’©å­ä¸èƒ½åœ¨ç»„ä»¶é—´å…±äº«ã€‚æ¯ä¸ªä½¿ç”¨ç¿»è¯‘çš„ç»„ä»¶éƒ½éœ€è¦è‡ªå·±çš„ useTranslationï¼ˆï¼‰ã€‚
    
3. <mark>Debugging without errors is harder.<br>è°ƒè¯•æ—¶æ²¡æœ‰errorsè­¦ç¤ºæ›´éš¾ã€‚</mark>
    
4. Testing is crucial.  
    æµ‹è¯•è‡³å…³é‡è¦ã€‚
    
5. AI tools are helpful learning partners. When I got stuck, I used AI assistants to understand best practices, but I still had to understand and implement the solutions myself.  
    AI å·¥å…·æ˜¯æœ‰ç”¨çš„å­¦ä¹ ä¼™ä¼´ã€‚å½“æˆ‘é‡åˆ°å›°éš¾æ—¶ï¼Œæˆ‘ç”¨ AI åŠ©æ‰‹æ¥ç†è§£æœ€ä½³å®è·µï¼Œä½†è§£å†³æ–¹æ¡ˆè¿˜æ˜¯å¾—è‡ªå·±ç†è§£å’Œå®æ–½ã€‚
    

## The Result ç»“æœ

Now my admin system seamlessly switches between three languages with a single click. Users' language preferences persist across sessions, and every piece of text in the interface is properly internationalized.  
ç°åœ¨æˆ‘çš„ç®¡ç†ç³»ç»Ÿåªéœ€ä¸€é”®å°±èƒ½æ— ç¼åˆ‡æ¢ä¸‰ç§è¯­è¨€ã€‚ç”¨æˆ·çš„è¯­è¨€åå¥½åœ¨ä¼šè¯ä¸­ä¿æŒä¸å˜ï¼Œç•Œé¢ä¸­çš„æ¯ä¸€æ®µæ–‡æœ¬éƒ½å¾—åˆ°äº†é€‚å½“çš„å›½é™…åŒ–ã€‚

This feature not only made my application more accessible but also taught me valuable lessons about React lifecycle, hooks, and the importance of thorough testing.  
è¿™ä¸€åŠŸèƒ½ä¸ä»…è®©æˆ‘çš„åº”ç”¨æ›´æ˜“ä½¿ç”¨ï¼Œä¹Ÿè®©æˆ‘å­¦åˆ°äº†å…³äº React ç”Ÿå‘½å‘¨æœŸã€é’©å­ä»¥åŠå…¨é¢æµ‹è¯•é‡è¦æ€§çš„å®è´µç»éªŒã€‚
